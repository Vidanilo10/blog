<div class="music-container">
  <h1>Music Collection</h1>

  <!-- Spotify Connection Section -->
  <section class="music-section spotify-auth-section" *ngIf="!isSpotifyConnected">
    <h2>ðŸŽµ Connect Your Spotify</h2>
    <p class="connect-description">
      Connect your Spotify account to see your personal playlists and favorite tracks!
    </p>
    <button class="spotify-connect-btn" (click)="connectSpotify()">
      <span class="spotify-icon">â™«</span> Connect with Spotify
    </button>
  </section>

  <!-- Loading Indicator -->
  <section class="music-section loading-section" *ngIf="isSpotifyConnected && isLoading">
    <div class="loading-spinner">
      <p>Loading your Spotify data...</p>
    </div>
  </section>

  <!-- User Profile Section -->
  <section class="music-section user-profile-section" *ngIf="isSpotifyConnected && userProfile">
    <div class="section-header">
      <div class="profile-info">
        <img *ngIf="userProfile.images && userProfile.images.length > 0" 
             [src]="userProfile.images[0].url" 
             alt="Profile" 
             class="profile-image">
        <div>
          <h2>Welcome, {{ userProfile.display_name }}! ðŸŽµ</h2>
          <p class="profile-stats">
            {{ userProfile.followers?.total || 0 }} followers
            <span *ngIf="userPlaylists.length > 0"> â€¢ {{ userPlaylists.length }} playlists</span>
          </p>
        </div>
      </div>
      <button class="disconnect-btn" (click)="disconnectSpotify()">Disconnect</button>
    </div>
  </section>

  <!-- Top Tracks Section -->
  <section class="music-section" *ngIf="isSpotifyConnected && topTracks.length > 0">
    <h2>ðŸ”¥ Your Top Tracks</h2>
    <div class="tracks-grid">
      <div class="track-card" *ngFor="let track of topTracks.slice(0, 10); let i = index">
        <div class="track-number">{{ i + 1 }}</div>
        <img [src]="track.album.images[0].url" [alt]="track.name" class="track-image">
        <div class="track-info">
          <h3 class="track-name">{{ track.name }}</h3>
          <p class="track-artist">{{ track.artists[0].name }}</p>
          <p class="track-album">{{ track.album.name }}</p>
        </div>
        <a [href]="track.external_urls.spotify" target="_blank" class="play-btn" title="Play on Spotify">
          â–¶
        </a>
      </div>
    </div>
  </section>

  <!-- User Playlists Section -->
  <section class="music-section" *ngIf="isSpotifyConnected && userPlaylists.length > 0">
    <h2>ðŸ“š Your Playlists</h2>
    <div class="playlists-grid">
      <div class="playlist-card" *ngFor="let playlist of userPlaylists.slice(0, 6)">
        <iframe 
          [src]="getSafeSpotifyPlaylistUrl(playlist.id)"
          width="100%" 
          height="380" 
          frameBorder="0" 
          allowfullscreen="" 
          allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" 
          loading="lazy">
        </iframe>
        <p class="playlist-name">{{ playlist.name }}</p>
      </div>
    </div>
  </section>

  <!-- Default Spotify Section -->
  <section class="music-section">
    <h2>ðŸŽµ Featured Playlist</h2>
    <div class="spotify-container">
      <iframe 
        [src]="spotifyPlaylistUrl"
        width="100%" 
        height="380" 
        frameBorder="0" 
        allowfullscreen="" 
        allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" 
        loading="lazy">
      </iframe>
    </div>
    <p class="api-info">
      <strong>Note:</strong> To customize this with your own playlists:
      <br>1. Get a Spotify playlist share link
      <br>2. Replace the playlist ID in the component
      <br>3. For advanced features, connect your Spotify account above!
    </p>
  </section>

  <!-- YouTube Section -->
  <section class="music-section">
    <h2>ðŸ“º YouTube Videos</h2>
    <div class="youtube-grid">
      <div class="youtube-video" *ngFor="let video of youtubeVideos">
        <iframe 
          [src]="getSafeYoutubeUrl(video.id)"
          width="100%" 
          height="315" 
          frameborder="0" 
          allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
          allowfullscreen
          loading="lazy">
        </iframe>
        <p class="video-title">{{ video.title }}</p>
      </div>
    </div>
    <p class="api-info">
      <strong>Note:</strong> To use YouTube Data API:
      <br>1. Create a project in Google Cloud Console
      <br>2. Enable YouTube Data API v3
      <br>3. Create API credentials
      <br>4. Use the API to fetch and display your playlists dynamically
    </p>
  </section>

  <div class="integration-guide">
    <h3>ðŸ”§ API Integration Guide</h3>
    <div class="guide-content">
      <div class="api-card">
        <h4>Spotify Web API</h4>
        <ul>
          <li>Register your app at <a href="https://developer.spotify.com" target="_blank">developer.spotify.com</a></li>
          <li>Get Client ID and Client Secret</li>
          <li>Implement OAuth 2.0 authentication</li>
          <li>Access user playlists, tracks, and player controls</li>
        </ul>
      </div>
      <div class="api-card">
        <h4>YouTube Data API</h4>
        <ul>
          <li>Create project at <a href="https://console.cloud.google.com" target="_blank">Google Cloud Console</a></li>
          <li>Enable YouTube Data API v3</li>
          <li>Generate API key or OAuth credentials</li>
          <li>Fetch playlists, videos, and channel information</li>
        </ul>
      </div>
    </div>
  </div>
</div>
